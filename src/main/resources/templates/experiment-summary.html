<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head><title>Experiment Complete</title><meta charset="UTF-8">
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',sans-serif;background:#f5f7fa}
.navbar{background:linear-gradient(135deg,#667eea,#764ba2);color:white;padding:15px 20px}
.navbar-content{max-width:1000px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}
.navbar h1{font-size:20px}.navbar a{color:white;text-decoration:none;padding:8px 14px;border-radius:5px}
.navbar a:hover{background:rgba(255,255,255,.2)}
.container{max-width:1000px;margin:30px auto;padding:0 20px}
.hero{background:white;padding:40px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,.1);text-align:center;margin-bottom:25px}
.hero .icon{font-size:72px;margin-bottom:15px}
.hero h2{font-size:30px;margin-bottom:10px}
.hero p{color:#666;font-size:16px}
.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:15px;margin-bottom:25px}
.stat{background:white;padding:20px;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,.08);text-align:center}
.stat .n{font-size:28px;font-weight:bold;color:#667eea}.stat .l{font-size:12px;color:#666;margin-top:4px}
.card{background:white;padding:25px;border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.08);margin-bottom:20px}
.card h3{font-size:18px;margin-bottom:15px;color:#333}
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{padding:11px 13px;text-align:left;border-bottom:1px solid #f0f0f0}
th{background:#f9f9f9;color:#666;text-transform:uppercase;font-size:11px}
.pos{color:#16a34a;font-weight:600}.neg{color:#dc2626;font-weight:600}.neu{color:#f59e0b;font-weight:600}
.done-msg{background:#dcfce7;border:1px solid #bbf7d0;color:#166534;padding:15px 20px;border-radius:8px;text-align:center;margin-bottom:20px;font-weight:500}
.logout-btn{display:inline-block;padding:12px 30px;background:#667eea;color:white;text-decoration:none;border-radius:8px;font-weight:500;margin-top:15px}
</style></head>
<body>
<div class="navbar"><div class="navbar-content">
  <h1>üìä Trading Experiment</h1>
  <a href="/logout">Logout</a>
</div></div>

<div class="container">
  <div class="done-msg">‚úÖ Experiment Complete ‚Äî Thank you for participating!</div>

  <div class="hero">
    <div class="icon">üèÜ</div>
    <h2>Well done, <span th:text="${summary.fullName}">User</span>!</h2>
    <p>You completed <span th:text="${summary.totalDecisions}">100</span> trading decisions across 10 stocks.</p>
  </div>

  <div class="stats">
    <div class="stat"><div class="n" th:text="${summary.totalDecisions}">100</div><div class="l">Total Decisions</div></div>
    <div class="stat"><div class="n pos" th:text="${summary.totalBuys}">0</div><div class="l">Buys</div></div>
    <div class="stat"><div class="n neg" th:text="${summary.totalSells}">0</div><div class="l">Sells</div></div>
    <div class="stat"><div class="n neu" th:text="${summary.totalHolds}">0</div><div class="l">Holds</div></div>
    <div class="stat">
      <div class="n" th:classappend="${summary.averageReturn >= 0 ? 'pos' : 'neg'}">
        <span th:text="${summary.averageReturn >= 0 ? '+' : ''}"></span><span th:text="${#numbers.formatDecimal(summary.averageReturn,0,2,'POINT')}"></span>%
      </div>
      <div class="l">Avg Return / Stock</div>
    </div>
  </div>

  <div class="card" th:if="${!summary.stockSummaries.isEmpty()}">
    <h3>Per-Stock Results</h3>
    <table>
      <thead><tr><th>Stock</th><th>Start Capital</th><th>End Capital</th><th>P&amp;L</th><th>Return</th><th>B/S/H</th></tr></thead>
      <tbody>
        <tr th:each="ss,i : ${summary.stockSummaries}" th:unless="${ss.empty}">
          <td>Episode <span th:text="${i.count}"></span></td>
          <td>‚Çπ<span th:text="${#numbers.formatDecimal(ss.initialCapital,0,'COMMA',0,'POINT')}"></span></td>
          <td>‚Çπ<span th:text="${#numbers.formatDecimal(ss.finalCapital,0,'COMMA',0,'POINT')}"></span></td>
          <td th:classappend="${ss.returnAmount >= 0 ? 'pos' : 'neg'}">
            <span th:text="${ss.returnAmount >= 0 ? '+' : ''}"></span>‚Çπ<span th:text="${#numbers.formatDecimal(ss.returnAmount,0,'COMMA',0,'POINT')}"></span>
          </td>
          <td th:classappend="${ss.returnPercent >= 0 ? 'pos' : 'neg'}">
            <span th:text="${ss.returnPercent >= 0 ? '+' : ''}"></span><span th:text="${#numbers.formatDecimal(ss.returnPercent,0,2,'POINT')}"></span>%
          </td>
          <td th:text="${ss.buyCount}+'/'+${ss.sellCount}+'/'+${ss.holdCount}"></td>
        </tr>
      </tbody>
    </table>
  </div>

  <div style="text-align:center">
    <p style="color:#666;font-size:15px">Your results have been recorded. You may now close this tab.</p>
    <a href="/logout" class="logout-btn">Logout</a>
  </div>
</div>
</body></html>
