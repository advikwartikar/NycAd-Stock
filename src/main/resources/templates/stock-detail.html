<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Stock Details</title>
    <meta charset="UTF-8">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #f5f7fa; }
        .navbar { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px 20px; }
        .navbar-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; }
        .navbar a { color: white; text-decoration: none; padding: 8px 16px; }
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        .back-btn { background: #667eea; color: white; padding: 10px 20px; border-radius: 5px; text-decoration: none; display: inline-block; margin-bottom: 20px; }
        .stock-detail { background: white; padding: 30px; border-radius: 10px; margin-bottom: 20px; }
        .stock-header { display: flex; justify-content: space-between; margin-bottom: 20px; }
        .stock-info h1 { font-size: 32px; color: #333; margin-bottom: 10px; }
        .stock-info p { color: #666; }
        .price-box { text-align: right; }
        .current-price { font-size: 48px; font-weight: bold; color: #667eea; }
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin: 30px 0; }
        .stat { background: #f5f7fa; padding: 20px; border-radius: 8px; text-align: center; }
        .stat-label { color: #666; font-size: 14px; margin-bottom: 5px; }
        .stat-value { font-size: 24px; font-weight: bold; color: #333; }
        .trade-section { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .trade-box { background: #f5f7fa; padding: 25px; border-radius: 10px; }
        .trade-box h3 { margin-bottom: 15px; color: #333; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; color: #666; font-weight: 500; }
        .form-group input { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 5px; font-size: 16px; }
        .btn-buy { width: 100%; padding: 15px; background: #4caf50; color: white; border: none; border-radius: 5px; font-size: 16px; font-weight: bold; cursor: pointer; }
        .btn-sell { width: 100%; padding: 15px; background: #f44336; color: white; border: none; border-radius: 5px; font-size: 16px; font-weight: bold; cursor: pointer; }
        .btn-buy:hover { background: #45a049; }
        .btn-sell:hover { background: #da190b; }
        .total-cost { margin-top: 10px; padding: 10px; background: white; border-radius: 5px; text-align: center; font-weight: bold; }
    </style>
    <script>
        function updateBuyCost() {
            var quantity = document.getElementById('buyQuantity').value || 0;
            var price = parseFloat(document.getElementById('stockPrice').value);
            var total = quantity * price;
            document.getElementById('buyCost').textContent = '‚Çπ' + total.toLocaleString('en-IN', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }
        
        function updateSellRevenue() {
            var quantity = document.getElementById('sellQuantity').value || 0;
            var price = parseFloat(document.getElementById('stockPrice').value);
            var total = quantity * price;
            document.getElementById('sellRevenue').textContent = '‚Çπ' + total.toLocaleString('en-IN', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }
    </script>
</head>
<body>
    <div class="navbar">
        <div class="navbar-content">
            <h1>üìà Stock Trading</h1>
            <div>
                <a href="/dashboard">Dashboard</a>
                <a href="/stocks">Stocks</a>
                <a href="/portfolio">Portfolio</a>
                <a href="/logout">Logout</a>
            </div>
        </div>
    </div>
    
    <div class="container">
        <a href="/stocks" class="back-btn">‚Üê Back to Stocks</a>
        
        <div class="stock-detail">
            <div class="stock-header">
                <div class="stock-info">
                    <h1 th:text="${stock.symbol}"></h1>
                    <p th:text="${stock.name}"></p>
                </div>
                <div class="price-box">
                    <div class="current-price">‚Çπ<span th:text="${#numbers.formatDecimal(stock.currentPrice, 0, 'COMMA', 2, 'POINT')}"></span></div>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat">
                    <div class="stat-label">Open</div>
                    <div class="stat-value">‚Çπ<span th:text="${#numbers.formatDecimal(stock.openPrice, 0, 2, 'POINT')}"></span></div>
                </div>
                <div class="stat">
                    <div class="stat-label">High</div>
                    <div class="stat-value">‚Çπ<span th:text="${#numbers.formatDecimal(stock.highPrice, 0, 2, 'POINT')}"></span></div>
                </div>
                <div class="stat">
                    <div class="stat-label">Low</div>
                    <div class="stat-value">‚Çπ<span th:text="${#numbers.formatDecimal(stock.lowPrice, 0, 2, 'POINT')}"></span></div>
                </div>
                <div class="stat">
                    <div class="stat-label">Close</div>
                    <div class="stat-value">‚Çπ<span th:text="${#numbers.formatDecimal(stock.closePrice, 0, 2, 'POINT')}"></span></div>
                </div>
                <div class="stat">
                    <div class="stat-label">Volume</div>
                    <div class="stat-value" th:text="${#numbers.formatInteger(stock.volume, 0, 'COMMA')}"></div>
                </div>
                <div class="stat">
                    <div class="stat-label">SMA</div>
                    <div class="stat-value">‚Çπ<span th:text="${#numbers.formatDecimal(stock.sma, 0, 2, 'POINT')}"></span></div>
                </div>
                <div class="stat">
                    <div class="stat-label">RSI</div>
                    <div class="stat-value" th:text="${#numbers.formatDecimal(stock.rsi, 0, 2, 'POINT')}"></div>
                </div>
                <div class="stat">
                    <div class="stat-label">Your Credits</div>
                    <div class="stat-value">‚Çπ<span th:text="${#numbers.formatDecimal(user.credits, 0, 'COMMA', 0, 'POINT')}"></span></div>
                </div>
            </div>
            
            <div class="trade-section">
                <div class="trade-box">
                    <h3>Buy Stocks</h3>
                    <form th:action="@{/trade/buy}" method="post">
                        <input type="hidden" name="stockId" th:value="${stock.id}">
                        <input type="hidden" id="stockPrice" th:value="${stock.currentPrice}">
                        <div class="form-group">
                            <label>Quantity</label>
                            <input type="number" name="quantity" id="buyQuantity" min="1" required onkeyup="updateBuyCost()" onchange="updateBuyCost()">
                        </div>
                        <div class="total-cost">Total Cost: <span id="buyCost">‚Çπ0.00</span></div>
                        <button type="submit" class="btn-buy">Buy Now</button>
                    </form>
                </div>
                
                <div class="trade-box">
                    <h3>Sell Stocks</h3>
                    <form th:action="@{/trade/sell}" method="post">
                        <input type="hidden" name="stockId" th:value="${stock.id}">
                        <div class="form-group">
                            <label>Quantity</label>
                            <input type="number" name="quantity" id="sellQuantity" min="1" required onkeyup="updateSellRevenue()" onchange="updateSellRevenue()">
                        </div>
                        <div class="total-cost">Total Revenue: <span id="sellRevenue">‚Çπ0.00</span></div>
                        <button type="submit" class="btn-sell">Sell Now</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
